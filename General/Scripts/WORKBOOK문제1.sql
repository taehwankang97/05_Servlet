--1-1.
SELECT
DEPARTMENT_NAME,
CATEGORY
FROM TB_DEPARTMENT;

--1-2.
SELECT
	 DEPARTMENT_NAME||
	 '학과의 정원은 '
	 ||CAPACITY||
	 '명 입니다.'
	 AS "학과별 정원"
FROM TB_DEPARTMENT;

--1-3.
SELECT 
STUDENT_NAME
FROM 
	TB_STUDENT
WHERE 
	DEPARTMENT_NO = '001' 
	AND ABSENCE_YN = 'Y'
	AND SUBSTR(STUDENT_SSN,8,1) = '2';
	
	--1-4.
	SELECT
	STUDENT_NAME
	FROM TB_STUDENT
	WHERE
		STUDENT_NO IN ('A513079', 'A513090', 'A513091', 'A513110', 'A513119');

	--1-5
		SELECT
		DEPARTMENT_NAME,
		CAPACITY
		FROM
		TB_DEPARTMENT
		WHERE
		CAPACITY >=20 AND CAPACITY <=30 ;
	
	--1-6
	SELECT
	PROFESSOR_NAME 
	FROM
	 TB_PROFESSOR 
	WHERE
	DEPARTMENT_NO  IS NULL;

--1-7
SELECT
CLASS_NO
FROM
 TB_CLASS 
WHERE
CLASS_NO IS NOT NULL;

 --1-8 
SELECT
DISTINCT(CATEGORY) 
FROM
TB_DEPARTMENT;

--1-9
SELECT
STUDENT_NO,
STUDENT_NAME,
STUDENT_SSN

FROM
TB_STUDENT 
WHERE
 ABSENCE_YN LIKE 'Y';
 
 --2-1
 SELECT
 STUDENT_NO,
 STUDENT_NAME,
 ENTRANCE_DATE
 FROM TB_STUDENT
 WHERE
 DEPARTMENT_NO LIKE '%2%';

--2-2
SELECT
PROFESSOR_NAME,
PROFESSOR_SSN
FROM
TB_PROFESSOR 
WHERE
PROFESSOR_NAME NOT LIKE '___';

-- 2-3
SELECT 
	PROFESSOR_NAME "교수이름",
	EXTRACT(YEAR FROM TO_DATE(CURRENT_DATE))
	-EXTRACT(YEAR FROM TO_DATE(SUBSTR(19||PROFESSOR_SSN, 1, 8), 'RRMMDD')) -1"나이"
FROM TB_PROFESSOR
WHERE
SUBSTR(PROFESSOR_SSN,8,1) LIKE '1'
ORDER BY 
"나이" ASC;


-- 2-4
SELECT
	SUBSTR(PROFESSOR_NAME, 2) "이름"
FROM TB_PROFESSOR;


-- 2-5

SELECT
	STUDENT_NO,
	STUDENT_NAME
FROM
	TB_STUDENT
WHERE
	EXTRACT(YEAR FROM TO_DATE(ENTRANCE_DATE))
	-EXTRACT(YEAR FROM TO_DATE(SUBSTR('19'||STUDENT_SSN, 1, 8), 'RRRRMMDD')) > 19;


-- 2-6
SELECT
	STUDENT_NO,
	STUDENT_NAME
FROM
	TB_STUDENT
WHERE
	EXTRACT(YEAR FROM TO_DATE(ENTRANCE_DATE)) < 2000;
	


-- 2-7
SELECT
	ROUND(AVG(POINT),1) "평점"
FROM
	TB_GRADE
WHERE
	STUDENT_NO = 'A517178';
 
 --2-8
 
SELECT
	DEPARTMENT_NO  "학과번호",
	
FROM 
  TB_DEPARTMENT
  JOIN TB_STUDENT USING (DEPARTMENT_NO)
 ;

--2-9

SELECT
COUNT(*)
FROM
 TB_STUDENT 
 WHERE
 COACH_PROFESSOR_NO IS  NULL;

--2-10

SELECT
	SUBSTR(TERM_NO,1,4), ROUND(AVG(POINT),1)
FROM
	TB_STUDENT
JOIN 
	TB_GRADE USING (STUDENT_NO)
WHERE 
	STUDENT_NO = 'A112113'
GROUP BY
	SUBSTR(TERM_NO,1,4);

-- 2-11
SELECT
	DEPARTMENT_NO, SUM(DECODE(ABSENCE_YN, 'Y', 1, 0))
FROM
TB_STUDENT
GROUP BY DEPARTMENT_NO
ORDER BY 1
;

-- 2-12
SELECT
 STUDENT_NAME, COUNT(STUDENT_NAME)
FROM
	TB_STUDENT
GROUP BY
	STUDENT_NAME
HAVING
	COUNT(STUDENT_NAME) > 1
ORDER BY 
STUDENT_NAME ASC
;

--2-13

SELECT SUBSTR(TERM_NO,1,4), SUBSTR(TERM_NO,5,3), AVG(POINT)
FROM
TB_STUDENT
JOIN 
	TB_GRADE USING (STUDENT_NO)
	WHERE 
	STUDENT_NO = 'A112113'
GROUP BY ROLLUP(TERM_NO,POINT);
	
-- 3-1
	SELECT
		STUDENT_NAME, 
		STUDENT_ADDRESS
	FROM 
		TB_STUDENT
	ORDER BY 
		STUDENT_NAME ASC;
	
-- 3-2 
	SELECT
		STUDENT_NAME,STUDENT_SSN
	FROM
		TB_STUDENT
	WHERE 
		ABSENCE_YN = 'Y'
	ORDER BY
	STUDENT_SSN DESC;

-- 3-3
	SELECT
		STUDENT_NAME, STUDENT_NO, STUDENT_ADDRESS
	FROM
		TB_STUDENT
	WHERE
		STUDENT_NO LIKE '9%'
	AND
		STUDENT_ADDRESS LIKE '경기도%'
	OR
		STUDENT_ADDRESS LIKE '강원도%'
	ORDER BY 
		STUDENT_NAME ASC;
	
-- 3-4
	SELECT
	PROFESSOR_NAME ,PROFESSOR_SSN  
	FROM
	 TB_PROFESSOR 
	JOIN TB_CLASS USING(DEPARTMENT_NO)
	WHERE
		CLASS_NAME LIKE '법%'	
	ORDER BY
	PROFESSOR_SSN ASC;

--3-5
	SELECT
		STUDENT_NO, TO_CHAR(POINT,'FM9.00')
	FROM
		 TB_STUDENT
	JOIN TB_GRADE USING(STUDENT_NO)  
	JOIN TB_CLASS USING (CLASS_NO)
	WHERE 
		CLASS_NO = 'C3118100'
	AND
		TERM_NO = '200402'
	ORDER BY 
	POINT DESC,
	STUDENT_NO DESC;
	
	--3-6

SELECT
 STUDENT_NO,
 STUDENT_NAME,
 DEPARTMENT_NAME
FROM
 TB_STUDENT 
 JOIN TB_DEPARTMENT USING (DEPARTMENT_NO)
 ORDER BY
 STUDENT_NAME ASC;

--3-7 

SELECT
CLASS_NAME,
DEPARTMENT_NAME
FROM
TB_CLASS
JOIN TB_DEPARTMENT USING (DEPARTMENT_NO );

--3-8 

SELECT
	CLASS_NAME, PROFESSOR_NAME ,
FROM
	TB_CLASS
	JOIN
	 TB_PROFESSOR USING (DEPARTMENT_NO );
	
	--3-9 
	SELECT
	CLASS_NAME, PROFESSOR_NAME
FROM
	TB_CLASS
	JOIN
	 TB_PROFESSOR USING (DEPARTMENT_NO )
	 JOIN 
	 TB_DEPARTMENT USING(DEPARTMENT_NO)
	WHERE
	CATEGORY = '인문사회';

--3-10
SELECT
STUDENT_NO, STUDENT_NAME, ROUND(AVG(POINT),1)
FROM
TB_STUDENT
JOIN TB_GRADE USING(STUDENT_NO)
JOIN TB_DEPARTMENT USING (DEPARTMENT_NO)
WHERE
	DEPARTMENT_NAME = '음악학과'
GROUP BY
STUDENT_NO, STUDENT_NAME;

-- 3-11 
 SELECT
		DEPARTMENT_NAME , STUDENT_NAME, PROFESSOR_NAME 
 FROM 
 	TB_DEPARTMENT 
 JOIN TB_STUDENT USING (DEPARTMENT_NO)
 LEFT JOIN TB_PROFESSOR USING (DEPARTMENT_NO)
 WHERE COACH_PROFESSOR_NO = PROFESSOR_NO;
 

 
-- 3-12
	SELECT
		STUDENT_NAME, TERM_NO
	FROM
		TB_STUDENT
	JOIN  TB_GRADE USING (STUDENT_NO)
	JOIN TB_CLASS USING  (CLASS_NO)
	WHERE 
		SUBSTR(TERM_NO,1,4) = '2007'
		AND
		CLASS_NAME = '인간관계론';

	--3-13
	
	SELECT CLASS_NAME, DEPARTMENT_NAME
	FROM TB_CLASS
	JOIN TB_DEPARTMENT USING(DEPARTMENT_NO)
	LEFT JOIN TB_CLASS_PROFESSOR USING(CLASS_NO)
	WHERE CATEGORY = '예체능'
	AND PROFESSOR_NO IS NULL;

--3-14
		
		SELECT
			STUDENT_NAME, PROFESSOR_NAME 
		FROM
			TB_STUDENT
		JOIN 
			TB_PROFESSOR USING (DEPARTMENT_NO);	
			
--3-15
	SELECT
		STUDENT_NO, STUDENT_NAME, DEPARTMENT_NAME , AVG(POINT)
	FROM
		TB_STUDENT
	JOIN 
		 TB_DEPARTMENT USING (DEPARTMENT_NO)
	JOIN 
		TB_GRADE USING (STUDENT_NO)
	GROUP BY 
		;




	
		
	 
